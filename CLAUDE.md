# MechaNyan プロジェクト指示書

## 言語設定

**重要**: このプロジェクトでは日本語でコミュニケーションを行ってください。

## プロジェクト概要

「NekoNyanMemoNote」（v1.2.5）- PyQt6ベースのWindows専用メモアプリケーション

### 主な機能

- 階層フォルダメモ管理、タブベース編集、行番号表示
- システムワイドホットキー（pynput）、自動テキスト入力
- フォント設定、読み取り専用モード、単一インスタンス制御
- ダークモード対応、非同期ファイルI/O、ストリーミング読み込み

## ファイル構造と開発環境

### 実行・ビルド

```bash
# 実行
python main.py

# EXE生成
pyinstaller --onefile --windowed --icon=favicon.ico main.py```

### 開発ガイドライン

- 既存コードスタイル・命名規則を維持
- 日本語コメント使用、適切なエラーハンドリング
- 機能追加時は既存クラス構造に従う
- ファイルパス安全処理（get_safe_path）、単一インスタンス制御維持

## 🤖 AI開発アシスタントの役割分担

### Claude Code（主要開発）
- プロジェクト全体設計・改善、PyQt6機能追加・修正
- デバッグ・エラー修正、ファイル操作、Git管理

### Gemini CLI（補完・検証）  
- コードレビュー・品質チェック、最適化提案
- セキュリティ検出、テスト生成、設計検証

### 使い分け戦略
開発→Claude Code、検証→Gemini CLI、問題解決→Claude Code

## 📊 現在の状況

### プロジェクト完了状況
**対応完了**: 34/34項目 (100%) - 全ての課題対応済み

### コード品質指標
- **総行数**: 4,873行（モジュール化完了）
- **アーキテクチャ**: 依存性注入、ファクトリパターン実装
- **パフォーマンス**: 非同期I/O、ストリーミング読み込み、メモリ最適化
- **テスト**: FileSystem/Settings/TabManager テスト完備

## ⚠️ 将来的なリスク（対策待ち）

### 高優先度
- **配布時権限問題**: Program Files配下でのデータ保存失敗
- **エンコーディング不整合**: BOM混在・CP932フォールバック
- **同期保存バックアップ**: 例外時データ消失リスク

### 中優先度  
- **大容量UIブロック**: HDD/ネットワークドライブでのフリーズ
- **ホットキー競合**: 管理者権限・他アプリとの競合
- **インスタンス制御**: 異常終了時の再起動不可
- **クラウド同期競合**: OneDrive等との保存競合

## 🛠️ 開発参考情報

### API使用例（同期デフォルト）
```python
# 同期読み込み（UI既定）
content = fs_manager.load_memo_content(file_path, force_sync=True)

# 非同期読み込み（任意）
fs_manager.load_memo_content_async(file_path, callback=on_loaded)

# ストリーミング読み込み（大容量向け）
fs_manager.load_memo_content_streaming(file_path, callback=on_chunk)
```
  